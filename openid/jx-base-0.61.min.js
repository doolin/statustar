/*
 * JX 0.61  - 24 Mar 2009
 * Copyright(c) 2008, Santosh Rajan
 * Author: Santosh Rajan
 * Email: santrajan@gmail.com
 * License: Dual License - MIT, GPL
 */
 
var JX={extend:function(C,E,D){var B=function(){};B.prototype=E.prototype;C.prototype=new B();C.prototype.constructor=C;C.superclass=E.prototype;for(var A in D){C.prototype[A]=D[A]}},setScope:function(B,A){return function(){return B.apply(A,arguments)}},namespace:function(){var C,D;for(var B=0;B<arguments.length;B++){C=window;D=arguments[B].split(".");for(var A in D){C=C[D[A]]=C[D[A]]?C[D[A]]:{}}}},isObject:function(A){return(A&&A.constructor&&A.constructor==Object.prototype.constructor&&!A.nodeName)?true:false},jxTypes:{component:"JX.Component",container:"JX.Container",columncontainer:"JX.ColumnContainer",selectfield:"JX.SelectField",textfield:"JX.TextField",buttonfield:"JX.ButtonField"}};JX.Component=function(){if(JX.isObject(arguments[0])){var A=arguments[0];A.jxtype=A.jxtype?A.jxtype:"div";A.jxtype=JX.jxTypes[A.jxtype]?"div":A.jxtype;JX.Component.superclass.init.call(this,document.createElement(A.jxtype));this.applyConfig(A)}else{if(arguments.length>0){JX.Component.superclass.init.apply(this,arguments)}else{JX.Component.superclass.init.call(this,document.createElement("div"))}}this[0]._jx=this};JX.extend(JX.Component,jQuery,{applyConfig:function(config){var a;this.css({overflow:"hidden"});for(var key in config){a=jQuery.isArray(config[key])?config[key]:[config[key]];for(var i=0;i<a.length;i++){if(config.scopeThis){a[i]=(typeof a[i]=="function")?JX.setScope(a[i],this):a[i]}}eval("this."+key+".apply(this, a)")}},jxtype:function(A){this._jxtype=A},fitWidth:function(A){this._fitWidth=A;return this},fitHeight:function(A){this._fitHeight=A;return this},scopeThis:function(A){this._scope=A},fieldName:function(A){this._fieldName=A},appendTo:function(A){JX.Component.superclass.appendTo.call(this,A);this.height(A.height());this.width(A.width())},setLoadIndicator:function(B,A,D){var C;this.children().each(function(){$(this).remove()});var F=(C=parseInt(this.height()/2-D/2))<0?"0px":C+"px";var E=(C=parseInt(this.width()/2-A/2))<0?"0px":C+"px";JX.Component.prototype.append.call(this,new JX.Component({jxtype:"image",attr:{src:B},css:{position:"relative",top:F,left:E}}))},removeLoadIndicator:function(){this.children().each(function(){$(this).remove()})},spacingHeight:function(){var A=0,B;A+=isNaN(B=parseInt(this.css("borderTopWidth")))?0:B;A+=isNaN(B=parseInt(this.css("borderBottomWidth")))?0:B;A+=isNaN(B=parseInt(this.css("paddingTop")))?0:B;A+=isNaN(B=parseInt(this.css("paddingBottom")))?0:B;return A},spacingWidth:function(){var A=0,B;A+=isNaN(B=parseInt(this.css("borderLeftWidth")))?0:B;A+=isNaN(B=parseInt(this.css("borderRightWidth")))?0:B;A+=isNaN(B=parseInt(this.css("paddingLeft")))?0:B;A+=isNaN(B=parseInt(this.css("paddingRight")))?0:B;return A},draggable:function(A){if($("#jxdraghelper")[0]==undefined){$("body").append('<div id="jxdraghelper"></div>')}var A=jQuery.extend({appendTo:"#jxdraghelper",helper:"clone",revert:"invalid",opacity:0.7,containment:"body"},A);JX.Component.superclass.draggable.call(this,A)}});JX.Container=function(){this._items=[];JX.Container.superclass.constructor.apply(this,arguments)};JX.extend(JX.Container,JX.Component,{applyConfig:function(config){JX.Container.superclass.applyConfig.apply(this,arguments);var c=this.citems?this.citems:[],item,obj;for(var i=0;i<c.length;i++){item=c[i];if(JX.isObject(item)){item.jxtype=item.jxtype?item.jxtype:"div";if(JX.jxTypes[item.jxtype]){eval("obj = new "+JX.jxTypes[item.jxtype]+"(item)")}else{obj=new JX.Component(item)}}else{obj=item}this.append(obj)}},append:function(A){JX.Container.superclass.append.apply(this,arguments);if(A instanceof JX.Component){this._items.push(A);A._parent=this;A._idx=this._items.length-1}return this},items:function(){this.citems=Array.prototype.slice.call(arguments)},onLayout:function(A){this._onLayout=A},doLayout:function(){if(this._onLayout){this._onLayout()}var D=this.height(),A,C;if(this.is(":hidden")){return }for(var B=0;B<this._items.length;B++){C=this._items[B];if(C._fitWidth){C.width(this.width()-C.spacingWidth())}if(C.is(":hidden")){continue}if(C._fitHeight){A=C;D-=C.spacingHeight()}else{D-=C.outerHeight()}}if(A){A.height(D)}for(var B in this._items){C=this._items[B];if(C.doLayout){JX.setScope(C.doLayout,C)()}}return this},getItems:function(){return this._items},trigger:function(){JX.Container.superclass.trigger.apply(this,arguments);if(this._items){for(var A=0;A<this._items.length;A++){this._items[A].trigger.apply(this._items[A],arguments)}}},removeItem:function(A){var B=this._items;B[A].remove();B.splice(A,1);this.setItemIndex()},droppable:function(A){this._drop=A.drop?A.drop:null;delete A.drop;var A=jQuery.extend({accept:function(){return true},drop:JX.setScope(this.drop,this)},A);JX.Container.superclass.droppable.call(this,A)},drop:function(E,C){var G=C.draggable[0]._jx;if(this._drop){this._drop(E,C,G,this);return }var F=C.position,A=this._items,D;for(var B=0;B<A.length;B++){D=A[B].position();if(this.isLess(F,D)){break}}G._parent.removeItem(G._idx);this.insertAt(G,B);this.dragEnable(G)},dragEnable:function(A){A.draggable("enable")},isLess:function(B,A){return(B.top<A.top)},insertAt:function(C,A){var B=this._items;if(A==B.length||B.length==0){this.append(C);return }C._parent=this;B.splice(A,0,C);this.setItemIndex();this.insertItemBefore(C,A+1)},insertItemBefore:function(B,A){this._items[A].before(B)},setItemIndex:function(){var A=this._items;for(var B=0;B<A.length;B++){A[B]._idx=B}}});JX.ColumnContainer=function(){if(arguments.length>0){JX.ColumnContainer.superclass.constructor.apply(this,arguments)}else{JX.ColumnContainer.superclass.constructor.call(this,{})}this._gridfix=0};JX.extend(JX.ColumnContainer,JX.Container,{applyConfig:function(A){$('<table border="0px" cellspacing="0px" cellpadding="0px"><tr></tr></table>').appendTo(this);JX.ColumnContainer.superclass.applyConfig.apply(this,arguments)},append:function(A){$("tr:first",this).append($(document.createElement("td")).append(A));if(A instanceof JX.Component){this._items.push(A);A._parent=this;A._idx=this._items.length-1}return this},doLayout:function(){if(this._onLayout){this._onLayout()}var A=this.height(),B,E;var D=this.width();if(!D){return }for(var C=0;C<this._items.length;C++){E=this._items[C];if(E._fitHeight){E.height(A-E.spacingHeight())}if(E._fitWidth){B=E;D-=E.spacingWidth()+this._gridfix;if(this._gridfix){this.width(this.width()-this._gridfix)}}else{D-=E.outerWidth()}}if(B){B.width(D)}for(var C=0;C<this._items.length;C++){E=this._items[C];if(E.doLayout){JX.setScope(E.doLayout,E)()}}return this},removeItem:function(A){var B=$(":parent:first",this._items[A]);JX.ColumnContainer.superclass.removeItem.call(this,A);B.remove()},gridfix:function(A){this._gridfix=A},isLess:function(B,A){return(B.left<A.left)},insertItemBefore:function(C,A){$("td",this).remove();var B=this._items.slice();this._items=[];for(var D=0;D<B.length;D++){this.append(B[D])}},dragEnable:function(A){for(var B=0;B<this._items.length;B++){this._items[B].draggable("enable")}}});JX.Viewport=function(){JX.Viewport.superclass.constructor.call(this,document.body);this.children().each(function(){$(this).hide()});this.css({padding:"0px",margin:"0px"});this.setSize();$(window).resize(JX.setScope(this.setSize,this));if(JX.isObject(arguments[0])){this.applyConfig(arguments[0]);this.setSize()}};JX.extend(JX.Viewport,JX.Container,{setSize:function(){this.height($(window).height()||window.innerHeight);this.width($(window).width());this.doLayout()}});JX.TextField=function(A){A=A?A:{};A.jxtype="input";JX.TextField.superclass.constructor.call(this,A);this.attr({type:"text"})};JX.extend(JX.TextField,JX.Component,{});JX.SelectField=function(A){A=A?A:{};A.jxtype="select";JX.SelectField.superclass.constructor.call(this,A)};JX.extend(JX.SelectField,JX.Component,{});JX.ButtonField=function(A){A=A?A:{};A.jxtype="input";JX.ButtonField.superclass.constructor.call(this,A);this.attr({type:"button"})};JX.extend(JX.ButtonField,JX.Component,{})